"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _plugin = require("@parcel/plugin");

var _path = _interopRequireDefault(require("path"));

var _camelcase = _interopRequireDefault(require("camelcase"));

var _svgToJsx = _interopRequireDefault(require("svg-to-jsx"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function getComponentName(filePath) {
  let validCharacters = /[^a-zA-Z0-9_-]/g;

  let name = _path.default.parse(filePath).name.replace(validCharacters, '');

  let pascalCaseFileName = (0, _camelcase.default)(name, {
    pascalCase: true
  });
  return `Svg${pascalCaseFileName}`;
}

var _default = new _plugin.Transformer({
  async transform({
    asset
  }) {
    let code = await asset.getCode();
    let componentName = getComponentName(asset.filePath);
    let jsx = await (0, _svgToJsx.default)(code);
    code = `import React from 'react';
    export default function ${componentName}(props) {
      return ${jsx.replace(/<svg (.*)>/, '<svg $1 {...props}>')};
    }
    `;
    asset.type = 'js';
    asset.setCode(code);
    return [asset];
  }

});

exports.default = _default;